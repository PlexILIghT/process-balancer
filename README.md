# Process Balancer Microservice

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –º–µ–∂–¥—É —Ä–∞–±–æ—á–∏–º–∏ –º–∞—à–∏–Ω–∞–º–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

[![Docker](https://img.shields.io/badge/Docker-23.0%2B-blue)](https://docker.com)
[![PHP](https://img.shields.io/badge/PHP-8.3%2B-purple)](https://php.net)
[![Symfony](https://img.shields.io/badge/Symfony-7.2%2B-green)](https://symfony.com)

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
    - [–° Docker](#—Å-docker)
    - [–ë–µ–∑ Docker](#–±–µ–∑-docker)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-api)
- [–ü—Ä–∏–º–µ—Ä—ã](#–ø—Ä–∏–º–µ—Ä—ã)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∏](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏)
- [–õ–∏—Ü–µ–Ω–∑–∏—è](#–ª–∏—Ü–µ–Ω–∑–∏—è)

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- ‚úÖ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –º–µ–∂–¥—É –º–∞—à–∏–Ω–∞–º–∏
- üîÑ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤:
    - ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞
    - ‚ùå Round-Robin (–í –ø–ª–∞–Ω–∞—Ö)
- üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞
- üî® –¢–µ—Å—Ç—ã –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone https://github.com/PlexILIghT/process-balancer.git
cd process-balancer
```

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
composer install
```

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ë–î –≤ .env.local:

```ini
DATABASE_URL="mysql://user:password@127.0.0.1:3306/process_balancer?serverVersion=8.0"
```

### –° Docker
–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

```bash
docker compose up --build
```
–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

```bash
docker compose exec php bin/console doctrine:migrations:migrate
```
–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8000

### –ë–µ–∑ Docker

–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

```bash
php bin/console doctrine:migrations:migrate
```
–ï—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏–π –Ω–µ –æ–∫–∞–∑–∞–ª–æ—Å—å, —Ç–æ —Å–æ–∑–¥–∞–π—Ç–µ –∏—Ö –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ
```bash
php bin/console make:migration
php bin/console doctrine:migrations:migrate
```
–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:
```bash
symfony server:start
```
## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API
–ú–∞—à–∏–Ω—ã

| –ú–µ—Ç–æ–¥  | –ü—É—Ç—å              | –û–ø–∏—Å–∞–Ω–∏–µ              |
|--------|-------------------|-----------------------|
| POST   | /api/machine      | –°–æ–∑–¥–∞—Ç—å –º–∞—à–∏–Ω—É        |
| DELETE | /api/machine/{id} | –£–¥–∞–ª–∏—Ç—å –º–∞—à–∏–Ω—É        |
| GET    | /api/machine      | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–∞—à–∏–Ω     |


–ü—Ä–æ—Ü–µ—Å—Å—ã

| –ú–µ—Ç–æ–¥  | –ü—É—Ç—å              | –û–ø–∏—Å–∞–Ω–∏–µ              |
|--------|-------------------|-----------------------|
| POST   | /api/process      | –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å       |
| DELETE | /api/process/{id} | –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å       |
| GET    | /api/process      | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ |

## –ü—Ä–∏–º–µ—Ä—ã
–°–æ–∑–¥–∞–Ω–∏–µ –º–∞—à–∏–Ω—ã:

```bash
curl -X POST -H "Content-Type: application/json" \
  -d '{"memory": 1000, "cpu": 4}' \
  http://localhost:8000/api/machine
```

–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞:

```bash
curl -X POST -H "Content-Type: application/json" \
  -d '{"memory": 500, "cpu": 2}' \
  http://localhost:8000/api/process
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤:

```bash
./bin/phpunit
```
–ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è:

```bash
# 1. –°–æ–∑–¥–∞–µ–º –º–∞—à–∏–Ω—É
# 2. –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å
# 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
# 4. –£–¥–∞–ª—è–µ–º –º–∞—à–∏–Ω—É
# 5. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–§–∞–π–ª .env:

```ini
APP_ENV=dev
DATABASE_URL=mysql://root:root@mysql:3306/process_balancer
# BALANCING_STRATEGY=min_load # –∏–ª–∏ round_robin (Not ready yet)
```

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
üêò PHP 8.3

üéª Symfony 7.2

üóÉÔ∏è MySQL 8.0

üê≥ Docker

### –õ–∏—Ü–µ–Ω–∑–∏—è
Apache License